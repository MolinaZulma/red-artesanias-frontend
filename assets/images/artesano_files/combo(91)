YUI.add("hermes-template-photo-well-media-scrappy",(function(n,t){var l=n.Template.Handlebars.revive({1:function(n,t,l,e,a){var o,i=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return null!=(o=(i(l,"isFlipped")||t&&i(t,"isFlipped")||n.hooks.helperMissing).call(null!=t?t:n.nullContext||{},"enable-nsfw-2024",{name:"isFlipped",hash:{},fn:n.program(2,a,0),inverse:n.program(4,a,0),data:a,loc:{start:{line:2,column:1},end:{line:29,column:15}}}))?o:""},2:function(n,t,l,e,a){var o,i=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return null!=(o=n.invokePartial(i(e,"adult-content-photo-overlay"),t,{name:"adult-content-photo-overlay",hash:{containerHeight:null!=t?i(t,"height"):t,containerMaxWidth:"1024",containerMinHeight:"360",isLarge:null!=(o=null!=t?i(t,"nsfwOverlayConfig"):t)?i(o,"isLarge"):o,ctaMessage:null!=(o=null!=t?i(t,"nsfwOverlayConfig"):t)?i(o,"ctaMessage"):o,bottomMessage:null!=(o=null!=t?i(t,"nsfwOverlayConfig"):t)?i(o,"bottomMessage"):o,detailsMessage:null!=(o=null!=t?i(t,"nsfwOverlayConfig"):t)?i(o,"detailsMessage"):o,showIcon:null!=(o=null!=t?i(t,"nsfwOverlayConfig"):t)?i(o,"showIcon"):o},data:a,indent:"\t\t",helpers:l,partials:e,decorators:n.decorators}))?o:""},4:function(n,t,l,e,a){var o,i=null!=t?t:n.nullContext||{},s=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return'\t\t<div class="restricted-interstitial">\n\t\t\t<div class="restricted-interstitial-message">\n\t\t\t\t<h2>'+n.escapeExpression((s(l,"intlMessage")||t&&s(t,"intlMessage")||n.hooks.helperMissing).call(i,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.ADULT_CONTENT"},data:a,loc:{start:{line:16,column:8},end:{line:16,column:67}}}))+"</h2>\n"+(null!=(o=s(l,"if").call(i,null!=t?s(t,"isSignedIn"):t,{name:"if",hash:{},fn:n.program(5,a,0),inverse:n.program(8,a,0),data:a,loc:{start:{line:17,column:4},end:{line:26,column:11}}}))?o:"")+"\t\t\t</div>\n\t\t</div>\n"},5:function(n,t,l,e,a){var o,i=null!=t?t:n.nullContext||{},s=n.hooks.helperMissing,r=n.escapeExpression,c=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return"\t\t\t\t\t<p>"+r((c(l,"intlMessage")||t&&c(t,"intlMessage")||s).call(i,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.MATURE_AUDIENCES"},data:a,loc:{start:{line:18,column:8},end:{line:18,column:70}}}))+"<br />"+r((c(l,"intlMessage")||t&&c(t,"intlMessage")||s).call(i,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.USER_DISCRETION"},data:a,loc:{start:{line:18,column:76},end:{line:18,column:137}}}))+"</p>\n\n"+(null!=(o=c(l,"unless").call(i,null!=t?c(t,"isMinor"):t,{name:"unless",hash:{},fn:n.program(6,a,0),inverse:n.noop,data:a,loc:{start:{line:20,column:5},end:{line:23,column:16}}}))?o:"")},6:function(n,t,l,e,a){var o=null!=t?t:n.nullContext||{},i=n.hooks.helperMissing,s=n.escapeExpression,r=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return"\t\t\t\t\t\t<p><button class='ui-button'><span>"+s((r(l,"intlMessage")||t&&r(t,"intlMessage")||i).call(o,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.SHOW_ME_THIS_CONTENT_TYPE"},data:a,loc:{start:{line:21,column:41},end:{line:21,column:112}}}))+"</span></button></p>\n\t\t\t\t\t\t<p>"+s((r(l,"intlHTMLMessage")||t&&r(t,"intlHTMLMessage")||i).call(o,{name:"intlHTMLMessage",hash:{intlName:"photo-page-scrappy.CHANGE_SAFE_SEARCH_IN_SETTINGS"},data:a,loc:{start:{line:22,column:9},end:{line:22,column:89}}}))+"</p>\n"},8:function(n,t,l,e,a){var o,i=null!=t?t:n.nullContext||{},s=n.hooks.helperMissing,r=n.escapeExpression,c=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return"\t\t\t\t\t<p>"+r((c(l,"intlMessage")||t&&c(t,"intlMessage")||s).call(i,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.SIGNED_IN_FOR_CONTENT"},data:a,loc:{start:{line:25,column:8},end:{line:25,column:75}}}))+' <a href="//'+r("function"==typeof(o=null!=(o=c(l,"host")||(null!=t?c(t,"host"):t))?o:s)?o.call(i,{name:"host",hash:{},data:a,loc:{start:{line:25,column:87},end:{line:25,column:95}}}):o)+'/signin/" data-track="photoWellSignInClick">'+r((c(l,"intlMessage")||t&&c(t,"intlMessage")||s).call(i,{name:"intlMessage",hash:{intlName:"common.SIGN_IN"},data:a,loc:{start:{line:25,column:139},end:{line:25,column:180}}}))+"</a></p>\n"},10:function(n,t,l,e,a){var o,i=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return null!=(o=i(l,"if").call(null!=t?t:n.nullContext||{},null!=t?i(t,"isVideo"):t,{name:"if",hash:{},fn:n.program(11,a,0),inverse:n.program(13,a,0),data:a,loc:{start:{line:31,column:1},end:{line:51,column:8}}}))?o:""},11:function(n,t,l,e,a){var o,i=null!=t?t:n.nullContext||{},s=n.hooks.helperMissing,r="function",c=n.escapeExpression,u=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return'\t\t<div class="videoplayer main-photo" style="width:'+c(typeof(o=null!=(o=u(l,"width")||(null!=t?u(t,"width"):t))?o:s)===r?o.call(i,{name:"width",hash:{},data:a,loc:{start:{line:32,column:51},end:{line:32,column:60}}}):o)+"px; height:"+c(typeof(o=null!=(o=u(l,"height")||(null!=t?u(t,"height"):t))?o:s)===r?o.call(i,{name:"height",hash:{},data:a,loc:{start:{line:32,column:71},end:{line:32,column:81}}}):o)+'px;"><video id="video_1" poster="'+c(typeof(o=null!=(o=u(l,"src")||(null!=t?u(t,"src"):t))?o:s)===r?o.call(i,{name:"src",hash:{},data:a,loc:{start:{line:32,column:114},end:{line:32,column:121}}}):o)+'" class="video-js vjs-big-play-centered inherit-size"></video></div>\n'},13:function(n,t,l,e,a){var o,i=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return null!=(o=i(l,"if").call(null!=t?t:n.nullContext||{},null!=t?i(t,"showFuzzy"):t,{name:"if",hash:{},fn:n.program(14,a,0),inverse:n.program(16,a,0),data:a,loc:{start:{line:34,column:2},end:{line:50,column:9}}}))?o:""},14:function(n,t,l,e,a){var o,i=null!=t?t:n.nullContext||{},s=n.hooks.helperMissing,r="function",c=n.escapeExpression,u=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return'\t\t\t<span class="restricted-image main-photo" style="width:'+c(typeof(o=null!=(o=u(l,"width")||(null!=t?u(t,"width"):t))?o:s)===r?o.call(i,{name:"width",hash:{},data:a,loc:{start:{line:35,column:58},end:{line:35,column:67}}}):o)+"px;height:"+c(typeof(o=null!=(o=u(l,"height")||(null!=t?u(t,"height"):t))?o:s)===r?o.call(i,{name:"height",hash:{},data:a,loc:{start:{line:35,column:77},end:{line:35,column:87}}}):o)+'px;"></span>\n'},16:function(n,t,l,e,a){var o,i=null!=t?t:n.nullContext||{},s=n.hooks.helperMissing,r="function",c=n.escapeExpression,u=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return'\t\t\t<span class="facade-of-protection-neue" style="width:'+c(typeof(o=null!=(o=u(l,"width")||(null!=t?u(t,"width"):t))?o:s)===r?o.call(i,{name:"width",hash:{},data:a,loc:{start:{line:37,column:56},end:{line:37,column:65}}}):o)+"px;height:"+c(typeof(o=null!=(o=u(l,"height")||(null!=t?u(t,"height"):t))?o:s)===r?o.call(i,{name:"height",hash:{},data:a,loc:{start:{line:37,column:75},end:{line:37,column:85}}}):o)+'px;">\n\t\t\t\t'+c((u(l,"outlet")||t&&u(t,"outlet")||s).call(i,null!=t?u(t,"zoom-view"):t,{name:"outlet",hash:{},data:a,loc:{start:{line:38,column:4},end:{line:38,column:24}}}))+"\n\t\t\t\t"+c((u(l,"outlet")||t&&u(t,"outlet")||s).call(i,null!=t?u(t,"vr-overlay-view"):t,{name:"outlet",hash:{},data:a,loc:{start:{line:39,column:4},end:{line:39,column:30}}}))+'\n\t\t\t</span>\n\n\t\t\t<img width="'+c(typeof(o=null!=(o=u(l,"width")||(null!=t?u(t,"width"):t))?o:s)===r?o.call(i,{name:"width",hash:{},data:a,loc:{start:{line:42,column:15},end:{line:42,column:24}}}):o)+'" height="'+c(typeof(o=null!=(o=u(l,"height")||(null!=t?u(t,"height"):t))?o:s)===r?o.call(i,{name:"height",hash:{},data:a,loc:{start:{line:42,column:34},end:{line:42,column:44}}}):o)+'" src="'+c(typeof(o=null!=(o=u(l,"highResSrc")||(null!=t?u(t,"highResSrc"):t))?o:s)===r?o.call(i,{name:"highResSrc",hash:{},data:a,loc:{start:{line:42,column:51},end:{line:42,column:65}}}):o)+'" class="main-photo is-hidden" alt="'+c(typeof(o=null!=(o=u(l,"imgAltText")||(null!=t?u(t,"imgAltText"):t))?o:s)===r?o.call(i,{name:"imgAltText",hash:{},data:a,loc:{start:{line:42,column:101},end:{line:42,column:115}}}):o)+'">\n\t\t\t<script nonce="'+c(typeof(o=null!=(o=u(l,"cspNonce")||(null!=t?u(t,"cspNonce"):t))?o:s)===r?o.call(i,{name:"cspNonce",hash:{},data:a,loc:{start:{line:43,column:18},end:{line:43,column:30}}}):o)+"\">\n\t\t\t\tvar img = document.querySelector('.photo-well-media-scrappy-view img.main-photo');\n\t\t\t\timg.onload = function () { registerFirstPhoto(img); };\n\t\t\t<\/script>\n\t\t\t<noscript>\n\t\t\t\t<img width=\""+c(typeof(o=null!=(o=u(l,"width")||(null!=t?u(t,"width"):t))?o:s)===r?o.call(i,{name:"width",hash:{},data:a,loc:{start:{line:48,column:16},end:{line:48,column:25}}}):o)+'" height="'+c(typeof(o=null!=(o=u(l,"height")||(null!=t?u(t,"height"):t))?o:s)===r?o.call(i,{name:"height",hash:{},data:a,loc:{start:{line:48,column:35},end:{line:48,column:45}}}):o)+'" src="'+c(typeof(o=null!=(o=u(l,"highResSrc")||(null!=t?u(t,"highResSrc"):t))?o:s)===r?o.call(i,{name:"highResSrc",hash:{},data:a,loc:{start:{line:48,column:52},end:{line:48,column:66}}}):o)+'" class="main-photo" alt="'+c(typeof(o=null!=(o=u(l,"imgAltText")||(null!=t?u(t,"imgAltText"):t))?o:s)===r?o.call(i,{name:"imgAltText",hash:{},data:a,loc:{start:{line:48,column:92},end:{line:48,column:106}}}):o)+'">\n\t\t\t</noscript>\n'},compiler:[8,">= 4.3.0"],main:function(n,t,l,e,a){var o,i=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return null!=(o=i(l,"if").call(null!=t?t:n.nullContext||{},null!=t?i(t,"needsInterstitial"):t,{name:"if",hash:{},fn:n.program(1,a,0),inverse:n.program(10,a,0),data:a,loc:{start:{line:1,column:0},end:{line:52,column:7}}}))?o:""},usePartial:!0,useData:!0}),e={};n.Array.each(["adult-content-photo-overlay"],(function(t){var l=n.Template.get("hermes/"+t);l&&(e[t]=l)})),n.Template.register("hermes/photo-well-media-scrappy",(function(t,a){return(a=a||{}).partials=a.partials?n.merge(e,a.partials):e,l(t,a)}))}),"@VERSION@",{requires:["template-base","handlebars-base","hermes-template-adult-content-photo-overlay"]});YUI.add("hermes-template-sub-photo-moola-view",(function(t,n){var e=t.Template.Handlebars.revive({1:function(t,n,e,a,r){return'\t\t\t\t\t\t<a target="_blank" href="/account/upgrade/pro" title="Flickr Pro">Flickr Pro</a>\n'},3:function(t,n,e,a,r){return'\t\t\t\t\t\t<a href="#" class="sponsored-title" title="Sponsored Advertiser">Sponsored Advertiser</a>\n'},5:function(t,n,e,a,r){return'\t\t\t\t\t\t\t<a target="_blank" href="/account/upgrade/pro">Sign up today!</a>\n'},7:function(t,n,e,a,r){return'\t\t\t\t\t\t\t<a target="_blank" href="https://flickrhelp.com/hc/en-us/articles/4404057954068-Ad-free-Browsing-and-Ad-free-Sharing-of-Photos">Learn more about ads</a>\n'},compiler:[8,">= 4.3.0"],main:function(t,n,e,a,r){var o,i,l=null!=n?n:t.nullContext||{},s=t.lookupProperty||function(t,n){if(Object.prototype.hasOwnProperty.call(t,n))return t[n]};return'<div class="sub-photo-container centered-content">\n\t<div class="sub-photo-content-container">\n\t\t<div class="view sub-photo-left-view">\n\t\t\t<div class="attribution-view photo-attribution">\n\t\t\t\t<a class="attribution-icon no-menu circle-icon" href="#" data-track="ad_link_rail_icon" target="_blank">\n\t\t\t\t\t<img src="'+t.escapeExpression("function"==typeof(i=null!=(i=s(e,"assetRoot")||(null!=n?s(n,"assetRoot"):n))?i:t.hooks.helperMissing)?i.call(l,{name:"assetRoot",hash:{},data:r,loc:{start:{line:6,column:15},end:{line:6,column:28}}}):i)+'/images/general/moola.png"/>\n\t\t\t\t</a>\n\n\t\t\t\t<div class="attribution-info">\n'+(null!=(o=s(e,"if").call(l,null!=n?s(n,"isProUpsell"):n,{name:"if",hash:{},fn:t.program(1,r,0),inverse:t.program(3,r,0),data:r,loc:{start:{line:10,column:5},end:{line:14,column:12}}}))?o:"")+'\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class="view sub-photo-title-desc-view" id="yui_3_16_0_rc_1_1_1401741750198_2372">\n\t\t\t\t<div class="title-desc-block">\n\t\t\t\t\t<span class=" meta-field photo-title ">\n'+(null!=(o=s(e,"if").call(l,null!=n?s(n,"isProUpsell"):n,{name:"if",hash:{},fn:t.program(5,r,0),inverse:t.program(7,r,0),data:r,loc:{start:{line:21,column:6},end:{line:25,column:13}}}))?o:"")+'\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="view sub-photo-right-view">\n\t\t\t<a href="/account/upgrade/pro" class="find-out-more" data-track="ad_link_rail_panel" target="_blank">\n\t\t\t\tAd free browsing? Sign up for Flickr Pro\n\t\t\t</a>\n\t\t</div>\n\t</div>\n</div>\n'},useData:!0}),a={};t.Array.each([],(function(n){var e=t.Template.get("hermes/"+n);e&&(a[n]=e)})),t.Template.register("hermes/sub-photo-moola-view",(function(n,r){return(r=r||{}).partials=r.partials?t.merge(a,r.partials):a,e(n,r)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-photo-well-media-interstitial-moola",(function(e,a){var t=e.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(e,a,t,r,i){var l,n=e.lookupProperty||function(e,a){if(Object.prototype.hasOwnProperty.call(e,a))return e[a]};return'<div class="photo-page-i-m-container">\n'+(null!=(l=e.invokePartial(n(r,"prbd-moola-position"),a,{name:"prbd-moola-position",hash:{upgradeProLink:null!=a?n(a,"upgradeProLink"):a,advertisingStitching:null!=a?n(a,"advertisingStitching"):a,signedOut:null!=a?n(a,"signedOut"):a,upsellFallback:null!=a?n(a,"upsellFallback"):a,adUnit:null!=a?n(a,"adUnit"):a,adTimerStartCount:null!=a?n(a,"adTimerStartCount"):a},data:i,indent:"\t",helpers:t,partials:r,decorators:e.decorators}))?l:"")+"</div>\n"},usePartial:!0,useData:!0}),r={};e.Array.each(["prbd-moola-position"],(function(a){var t=e.Template.get("hermes/"+a);t&&(r[a]=t)})),e.Template.register("hermes/photo-well-media-interstitial-moola",(function(a,i){return(i=i||{}).partials=i.partials?e.merge(r,i.partials):r,t(a,i)}))}),"@VERSION@",{requires:["template-base","handlebars-base","hermes-template-prbd-moola-position"]});YUI.add("hermes-template-photo-well-media-interstitial-getty",(function(e,t){var a=e.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(e,t,a,l,r){var n=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return e.escapeExpression((n(a,"outlet")||t&&n(t,"outlet")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},null!=t?n(t,"getty-widget-view"):t,{name:"outlet",hash:{},data:r,loc:{start:{line:1,column:0},end:{line:1,column:28}}}))},useData:!0}),l={};e.Array.each([],(function(t){var a=e.Template.get("hermes/"+t);a&&(l[t]=a)})),e.Template.register("hermes/photo-well-media-interstitial-getty",(function(t,r){return(r=r||{}).partials=r.partials?e.merge(l,r.partials):l,a(t,r)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("photo-well-media-scrappy-view",(function(e,t){var i=new e.AgeAssuranceHelper,n=require("hermes-core/flog")(t),o=new e.SubscriptionsHelper,a={photo:{render:function(){var t,n,o,a=this,s=this.get("photo"),r="";if(a.preloadImage&&(a.preloadImage.onload=null),this.appContext.forceServerRender?n=t=this.getPhotoForDisplay({canvas:{width:Number.MAX_VALUE,height:Number.MAX_VALUE}}):(t=this.getPhotoForDisplay(),n=this.getPhotoForDisplay({includeSizes:["sq","q","t","s","n"]})),s.getValue("owner")&&(r=""===s.getValue("title").trim()?this.intlMessage({intlName:"common.UNTITLED"}):s.getValue("title"),r+=" | "+this.intlMessage({intlName:"common.BY_USER",user:s.getValue("owner").getValue("username")})),!(o=this.get("container").one(".main-photo"))||parseInt(o.getAttribute("width"),10)!==t.width||parseInt(o.getAttribute("height"),10)!==t.height){const o=this.appContext.getViewer().signedIn?"wrongSetting":"signedOut",a=this.get("viewerModel"),h=this.appContext.flipper.isFlipped("enable-country-restrictions")&&a?.getValue("effectiveSafesearchLevel")===i.SAFESEARCH_ON;this.setContainerWithTemplate("photo-well-media-scrappy",{width:t.width,height:t.height,src:n.url,highResSrc:t.url,imgAltText:r,needsInterstitial:s.getValue("needsInterstitial"),isSignedIn:this.appContext.getViewer().signedIn,isVideo:!1,isMinor:this.appContext.getViewer().isMinor||h,nsfwOverlayConfig:{...this.appContext.flipper.isFlipped("enable-nsfw-2024")?e.NSFWHelper.getPhotoPageConfig(o):{},photoId:this.photoId}})}return YUI.Env.isServer?(this.serverWidth=t.width,this.serverHeight=t.height):s.getValue("needsInterstitial")||(a.preloadImage=new Image,a.preloadImage.onload=function(){this.onloadFired||a.isActiveAndInDOM()&&(this.onloadFired=!0,a.get("container").one(".main-photo").removeClass("is-hidden").show())},a.preloadImage.src=t.url,a.preloadImage.complete&&a.preloadImage.onload()),this}},video:{render:function(){var t=this.get("photo"),i=this.getPhotoForDisplay({excludeSizes:[]}),n=i.url;if(this.appContext.flipper.isFlipped("disable-video-playback")&&(n="/images/en-us/video-unavailable/m.png"),YUI.Env.isServer){let t=i.width/i.height;i.width=i.width-e.config.flickr.photopage.sidebarWidth,i.height=i.width/t}if(!this.player||t.getValue("isVideoPending")||t.getValue("isVideoFailed")){const o=this.appContext.getViewer().signedIn?"wrongSetting":"signedOut";return this.setContainerWithTemplate("photo-well-media-scrappy",{width:i.width,height:i.height,src:n,needsInterstitial:t.getValue("needsInterstitial"),isVideo:!0,isSignedIn:this.appContext.getViewer().signedIn,"zoom-view":"",nsfwOverlayConfig:{...this.appContext.flipper.isFlipped("enable-nsfw-2024")?e.NSFWHelper.getPhotoPageConfig(o):{},photoId:this.photoId}}),this}return t.getValue("isVideoPending")||t.getValue("isVideoFailed")||(this.player.dimension?(this.player.dimension("width",i.width),this.player.dimension("height",i.height)):this.player.resize(i.width,i.height)),this}},ad:{render:function(){var t=e.config.flickr.moola.positions.interstitials[0],i={},n=this.appContext.viewportData.getWidth(),a=e.config.flickr.moola.ad_breakpoint_mobile_desktop;return this.adEventStitch=this.appContext.adManager.getHashedAdValue(this.appContext.adManager.getAdPositioning(this.get("container"))),this.adId=e.guid(),i.signedOut=!this.appContext.getViewer().signedIn,i.adTimerStartCount=t.ad_timer_start_value,i.adUnit=t[n<a?"ad_unit_mobile":"ad_unit_desktop"],i.advertisingStitching=this.adEventStitch,i.upgradeProLink=o.getProLandingPageUrl(o.UTM_HIDE_ADS),this.adUnit=i.adUnit,this.setContainerWithTemplate("photo-well-media-interstitial-moola",i),this}},gettyWidget:{render:function(){this.setContainerWithTemplate("photo-well-media-interstitial-getty")}}};e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,subviewConfig:{"zoom-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1},"vr-overlay-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,destinationContainer:".photo-well-media-scrappy-view",disabled:function(){return!this.appContext.flipper.isFlipped("enable-vr")}},"getty-widget-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,type:"interstitial",searchTerm:"cat",disabled:function(){return!this.appContext.gettyHelper.canShowWidgetType()||!this.appContext.gettyHelper.isPhotopageInterstitialWidget()||!this.isAd}}},initializer:function(t){return this.photoId=t.photoId,this.isAd=!!t.ad,this.geo=t.geo,this.adSlots=[],this.photoPageSideBarWidth=e.config.flickr.photopage.sidebarWidth,""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this},loadState:function(){const t=this;let i=[this.appContext.getModel("photo-models",this.photoId).then((t=>{if(this.set("photo",t),t.getValue("isVideo"))return new e.Promise((function(t,i){e.use("flickr-video-player",(function(){t()}))}))}))];return this.appContext.flipper.isFlipped("enable-nsfw-2024")&&(this.nsfwOverlayHelper=new e.NSFWHelper({appContext:this.appContext,viewerNsid:this.appContext.getViewer().nsid}),i.push(this.nsfwOverlayHelper.load())),this.appContext.flipper.isFlipped("enable-country-restrictions")&&i.push(t.appContext.getModel("person-models",t.appContext.getViewer().nsid).then((e=>{t.set("viewerModel",e)}))),Promise.all(i)},buildContainer:function(){return YUI.Env.isServer||this.set("clientRendered",!0),this.isAd?this.appContext.gettyHelper.isPhotopageInterstitialWidget()?a.gettyWidget.render.call(this):a.ad.render.call(this):this.get("photo").getValue("isVideo")?a.video.render.call(this):a.photo.render.call(this),!YUI.Env.isServer&&this.subviews["vr-overlay-view"]&&this.subviews["vr-overlay-view"].get("canVr")&&(this.canVR=!0,this.subviews["zoom-view"]&&this.subviews["zoom-view"].destroy({remove:!0})),this.get("photo").getValue("needsInterstitial")?(this.get("container").addClass("has-interstitial"),this.appContext.flipper.isFlipped("enable-nsfw-2024")&&this.get("container").addClass("with-nsfw-2024")):(this.get("container").removeClass("has-interstitial"),this.get("container").removeClass("with-nsfw-2024")),this},handleInterstitialDismissButtonClick:function(t){var i=this,o=this.get("personPreferences"),a=this.get("photo"),s=a.getValue("safetyLevel");e.rapidTracker.beacon(this.name,"restrictedContentInterstitialClick"),o.setValue("safeSearch",s),o.registry.remoteUpdate(i.appContext.auth.user.nsid).then((function(e){a.registry.attributeSearch({needsInterstitial:!0}).forEach((function(e){a.registry.getValue(e,"safetyLevel")<=o.getValue("safeSearch")&&a.registry.setValue(e,"needsInterstitial",!1)})),i.buildContainer(),i.fire("subviewViewEvent","photoWellResized")}),(function(e){n.error({err:e}),i.onError(i.intlMessage({intlName:"photo-page-scrappy.COULDNT_UPDATE_SETTINGS"}))}))},onParentViewEvent:function(e,t){t&&"photoWellResized"===t[0]&&(this.get("photo").getValue("needsInterstitial")||(this.set("canvasSizeIsDirty",!0),this.buildContainer()))},activate:function(){var t=this;return!this.get("photo").getValue("isVideo")||this.get("photo").getValue("isVideoPending")||this.get("photo").getValue("isVideoFailed")||(this.player=new e.FlickrVideoPlayer({container:t.get("container").one(".videoplayer"),model:t.get("photo"),appContext:t.appContext,videoNode:e.one("#video_1")?e.one("#video_1").getDOMNode():null,controlBar:{fullscreenToggle:!1}}),this.player.init(),this.on("destroy",(function(){t.player&&(t.player.destroy(),t.player=null)}))),this.get("photo").getValue("needsInterstitial")||this.registerEventHandler(e.on("flickr:photo-media-well-update",(function(e){t.set("canvasSizeIsDirty",!0),t.buildContainer()}))),this.appContext.getViewer().signedIn&&this.appContext.getModel("person-preferences-models",this.appContext.auth.user.nsid).then((function(e){t.set("personPreferences",e),t.get("photo").getValue("needsInterstitial")&&!this.appContext.getViewer().isMinor&&(this.appContext.flipper.isFlipped("enable-nsfw-2024")&&t.get("container").one(".adult-content-photo-overlay .cta")?t.registerEventHandler(t.get("container").one(".adult-content-photo-overlay .cta").on("click",(()=>{t.nsfwOverlayHelper.updateSafetyLevel({safetyLevel:t.get("photo").getValue("safetyLevel"),photoModelRegistry:t.get("photo").registry,onSuccess:()=>{t.buildContainer(),t.fire("subviewViewEvent","photoWellResized")},onError:e=>{n.error({err:e}),t.onError(t.intlMessage({intlName:"photo-page-scrappy.COULDNT_UPDATE_SETTINGS"}))}})}))):t.get("container").one(".restricted-interstitial-message button")&&t.registerEventHandler(t.get("container").one(".restricted-interstitial-message button").on("click",t.handleInterstitialDismissButtonClick,t)))})),this.isAd&&!this.appContext.gettyHelper.isPhotopageInterstitialWidget()&&(t.appContext.adManager.processAdsOnPage(),t.adUnit&&t.appContext.adManager.signalAdRequest(t),e.once("adPageChange",(function(){t.fire("subviewViewEvent","adPageTimeoutStart")}))),this},showUpsell:function(){var e=this.get("container"),t=e.one("#interstitial-photo-upsell"),i=e.one("iframe");t&&t.addClass("show-upsell"),i&&i.setStyle("display","none")},onError:function(t){new e.Views.FluidModal({appContext:this.appContext,dismissOnOverlayClick:!0,showCancelButton:!1,showCancelX:!0,title:this.intlMessage({intlName:"common.ERROR"}),actionButtonLabel:this.intlMessage({intlName:"common.OK"}),htmlMessage:t}).show()},getPhotoForDisplay:function(e){var t,i,n,o=this.getCanvasSize(),a=this.getPixelRatio();return e&&e.canvasSize&&(o=e.canvasSize),t=this.get("photo").getSizeToFit(o,e),i=Math.min(o.height/a,t.height),n=Math.min(o.width/a,t.width/t.height*i),i=Math.min(i,t.height/t.width*n),{width:Math.round(n),height:Math.round(i),url:t.url,pixelRatio:t.width/n}},getCanvasSize:function(){var t,i,n,o,a=this.getPixelRatio(),s=this.get("container"),r={width:500,height:500};let h,l,p;return this.get("canvasSizeIsDirty")?YUI.Env.isServer||(h=e.one(".navigate-target.navigate-prev")&&e.one(".navigate-target.navigate-prev").one(".hide-text")?e.one(".navigate-target.navigate-prev").one(".hide-text").get("offsetWidth"):0,l=e.one(".navigate-target.navigate-next")&&e.one(".navigate-target.navigate-next").one(".hide-text")?e.one(".navigate-target.navigate-next").one(".hide-text").get("offsetWidth"):0,p=0,this.appContext.adManager.userCanViewPhotoPageSidebar()&&this.appContext.viewportData.getWidthWithScrollbars()>=1081&&(p=h+l+this.photoPageSideBarWidth),i=this.get("container").ancestor(),n=s.getStyle("paddingTop")?parseInt(s.getStyle("paddingTop").match(/[0-9]+/)[0],10):0,o=s.getStyle("paddingBottom")?parseInt(s.getStyle("paddingBottom").match(/[0-9]+/)[0],10):0,40,40,i&&((t=i.get("region")).height=parseInt(i.getStyle("height").match(/[0-9]+/)[0],10)-(n+o),t.width=this.appContext.viewportData.viewport.width-80-p)):t=this.get("cachedCanvasSize"),this.appContext.viewportData.viewport.width>0&&(r={width:this.appContext.viewportData.viewport.width,height:this.appContext.viewportData.viewport.height-240}),t||(t={top:0,left:0,bottom:500,right:500,width:r.width,height:r.height}),t.height*=a,t.width*=a,t},getPixelRatio:function(){return this.appContext.getViewer().getPixelRatio()}},{ATTRS:{canvasSizeIsDirty:{value:!0,setter:function(e){return!!e}},cachedCanvasSize:{getter:function(t){return e.merge(t)},setter:function(t){return e.merge(t)}}}})}),"@VERSION@",{requires:["flickr-view","moment","vr-overlay-view","zoom-view","hermes-template-photo-well-media-scrappy","hermes-template-sub-photo-moola-view","hermes-template-photo-well-media-interstitial-moola","hermes-template-adult-content-photo-overlay","subscriptions-helper","getty-widget-view","hermes-template-photo-well-media-interstitial-getty","nsfw-helper","age-assurance-helper"],optionalRequires:["hermes-core"],optional:["photo-models"],langBundles:["common","photo-page-scrappy","adult-content-overlay"]});YUI.add("hermes-template-context-slider-photo",(function(n,l){var e=n.Template.Handlebars.revive({1:function(n,l,e,t,a){return" currentImage"},3:function(n,l,e,t,a){return" previousImages"},5:function(n,l,e,t,a){return" nextImages"},compiler:[8,">= 4.3.0"],main:function(n,l,e,t,a){var o,i,r=null!=l?l:n.nullContext||{},u=n.hooks.helperMissing,c="function",s=n.escapeExpression,m=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'<a\n\tclass="context-thumb emptyImage\n\t\t'+(null!=(o=m(e,"if").call(r,null!=l?m(l,"currentPhoto"):l,{name:"if",hash:{},fn:n.program(1,a,0),inverse:n.noop,data:a,loc:{start:{line:3,column:2},end:{line:3,column:42}}}))?o:"")+"\n\t\t"+(null!=(o=m(e,"if").call(r,null!=l?m(l,"previousBigPhotos"):l,{name:"if",hash:{},fn:n.program(3,a,0),inverse:n.noop,data:a,loc:{start:{line:4,column:2},end:{line:4,column:49}}}))?o:"")+"\n\t\t"+(null!=(o=m(e,"if").call(r,null!=l?m(l,"nextBigPhotos"):l,{name:"if",hash:{},fn:n.program(5,a,0),inverse:n.noop,data:a,loc:{start:{line:5,column:2},end:{line:5,column:41}}}))?o:"")+'"\n\thref="'+s(typeof(i=null!=(i=m(e,"url")||(null!=l?m(l,"url"):l))?i:u)===c?i.call(r,{name:"url",hash:{},data:a,loc:{start:{line:6,column:7},end:{line:6,column:14}}}):i)+'"\n\tstyle="left: '+s(typeof(i=null!=(i=m(e,"left")||(null!=l?m(l,"left"):l))?i:u)===c?i.call(r,{name:"left",hash:{},data:a,loc:{start:{line:7,column:14},end:{line:7,column:22}}}):i)+'px"\n\tdata-photo-id="'+s(typeof(i=null!=(i=m(e,"id")||(null!=l?m(l,"id"):l))?i:u)===c?i.call(r,{name:"id",hash:{},data:a,loc:{start:{line:8,column:16},end:{line:8,column:22}}}):i)+'"\n\tdata-position="'+s(typeof(i=null!=(i=m(e,"position")||(null!=l?m(l,"position"):l))?i:u)===c?i.call(r,{name:"position",hash:{},data:a,loc:{start:{line:9,column:16},end:{line:9,column:28}}}):i)+'"\n\ttitle="'+s(typeof(i=null!=(i=m(e,"title")||(null!=l?m(l,"title"):l))?i:u)===c?i.call(r,{name:"title",hash:{},data:a,loc:{start:{line:10,column:8},end:{line:10,column:17}}}):i)+'"\n\ttabindex="-1"\n>\n\t<img src="'+s(typeof(i=null!=(i=m(e,"background")||(null!=l?m(l,"background"):l))?i:u)===c?i.call(r,{name:"background",hash:{},data:a,loc:{start:{line:13,column:11},end:{line:13,column:25}}}):i)+'" loading="lazy">\n</a>\n'},useData:!0}),t={};n.Array.each([],(function(l){var e=n.Template.get("hermes/"+l);e&&(t[l]=e)})),n.Template.register("hermes/context-slider-photo",(function(l,a){return(a=a||{}).partials=a.partials?n.merge(t,a.partials):t,e(l,a)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-photo-page-sidebar-popular-photos",(function(e,l){var t=e.Template.Handlebars.revive({1:function(e,l,t,a,n){var o,r=e.escapeExpression,s=null!=l?l:e.nullContext||{},p=e.hooks.helperMissing,u=e.lookupProperty||function(e,l){if(Object.prototype.hasOwnProperty.call(e,l))return e[l]};return'\t<h3><a href="'+r(e.lambda(null!=(o=null!=l?u(l,"urls"):l)?u(o,"photostream"):o,l))+'" class="truncate see-more-link">'+r((u(t,"intlMessage")||l&&u(l,"intlMessage")||p).call(s,{name:"intlMessage",hash:{username:null!=(o=null!=l?u(l,"person"):l)?u(o,"displayname"):o,intlName:"photo-page-scrappy.PHOTO_PAGE_SIDEBAR_SEE_MORE_FROM"},data:n,loc:{start:{line:2,column:67},end:{line:2,column:173}}}))+'</a></h3>\n\t<div class="popular-photos-thumbs">\n\t\t'+r((u(t,"outlet")||l&&u(l,"outlet")||p).call(s,null!=l?u(l,"photo-list-view"):l,{name:"outlet",hash:{},data:n,loc:{start:{line:4,column:2},end:{line:4,column:28}}}))+"\n\t</div>\n"},compiler:[8,">= 4.3.0"],main:function(e,l,t,a,n){var o,r=e.lookupProperty||function(e,l){if(Object.prototype.hasOwnProperty.call(e,l))return e[l]};return null!=(o=r(t,"if").call(null!=l?l:e.nullContext||{},null!=l?r(l,"photos"):l,{name:"if",hash:{},fn:e.program(1,n,0),inverse:e.noop,data:n,loc:{start:{line:1,column:0},end:{line:6,column:7}}}))?o:""},useData:!0}),a={};e.Array.each([],(function(l){var t=e.Template.get("hermes/"+l);t&&(a[l]=t)})),e.Template.register("hermes/photo-page-sidebar-popular-photos",(function(l,n){return(n=n||{}).partials=n.partials?e.merge(a,n.partials):a,t(l,n)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("photo-page-sidebar-popular-photos-view",(function(t){t.namespace("Views")[this.name]=t.Base.create("photo-page-sidebar-popular-photos-view",t.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return this.nsid=t.nsid,this.pathAlias=t.pathAlias,this.perPage=4,this.sort="faves",this.currentlyViewedPhotoId=t.photoId,this.pathAlias?this.pathAlias:this.nsid,t.modelRegistryName="profile-popular-photos-models",t.photoListConfig={containerWidth:300,parentName:"profile-container",measureAFT:!0,paginateOnScroll:!1,relayoutOnResize:!1,maintainScrollPosition:!1,keepAwakeOnScroll:!0,pageParams:{id:this.nsid+"-"+this.sort,nsid:this.nsid,perPage:this.perPage,page:1,sort:this.sort},itemFilterFunction:function(t){return t.getValue("id")!==this.currentlyViewedPhotoId}.bind(this),injectPhotolistContextParams:{snowplowConfig:{category:"photopageinteractions",action:"photoPageSidebarPopularPhotosPhotoClick",label:""}}},t.photoListConfig.modelParams={registryName:"profile-popular-photos-models",modelIdOrAttributes:this.nsid+"-"+this.sort,collectionAttributeName:"photos",fetchParams:{id:this.nsid+"-"+this.sort,nsid:this.nsid,perPage:this.perPage,page:1,sort:this.sort}},t.photoListConfig.layout={targetRowHeight:80,targetRowHeightTolerance:0,maxNumRows:1,forceAspectRatio:1,containerPadding:{top:0,right:0,bottom:8,left:0},itemSpacing:{horizontal:4,vertical:4},showWidows:!1,alwaysDisplayOrphans:!1},this.photoListConfig=t.photoListConfig,this.params=t,this},subviewConfig:{"photo-list-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0}},loadState:function(){var e={id:this.nsid+"-"+this.sort,nsid:this.nsid,perPage:this.perPage,page:1,sort:this.sort};return t.Promise.all([this.appContext.getModel("profile-popular-photos-models",e),this.appContext.getModel("person-models",this.nsid)]).then(function(e){this.set("popularModel",e[0]),this.set("personModel",e[1]),this.set("personURLs",t.URLHelper.generatePersonUrls(e[1]))}.bind(this))},buildContainer:function(){return this.setContainerWithTemplate("photo-page-sidebar-popular-photos",{popularPhotos:this.get("popularModel").getValue("photos").getList().length>0,urls:this.get("personURLs"),photos:this.get("popularModel").getValue("photos").size(),person:this.get("personModel").toJSON()}),this},activate:function(){let e=this.get("container").one(".see-more-link");return e&&this.registerEventHandler(e.on("click",(function(e){t.Snowplough.sendStructuredEvent({category:"photopageinteractions",action:"photoPageSidebarPopularPhotosSeeMoreClick"})}))),this}})}),"@VERSION@",{requires:["flutil","flickr-view","photo-list-view","url-helper","profile-popular-photos-models","hermes-template-photo-page-sidebar-popular-photos"],langBundles:["common","photo-page-scrappy","profile"]});YUI.add("photo-page-scrolling-sidebar-view",(function(e,t){require("hermes-core/flog")(t);let o=new e.SubscriptionsHelper;e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,subviewConfig:{"attribution-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0,additionalViewClasses:["clear-float","photo-attribution"],parentViewName:this.name},"sub-photo-right-stats-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0,parentViewName:this.name},"sub-photo-date-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0,parentViewName:this.name},"getty-widget-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!1,type:"photoPage",sidebar:!0,disabled:function(){return this.isMobile||this.appContext.getViewer().isPro||this._params.ownerIsPro}},"photo-page-sidebar-popular-photos-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0}},initializer:function(t){return this.photoId=t.photoId,this.detachedConfig,this.showPhotoPageAd=!0,this.showGettyWidget=!1,this.nodeObserver,this.sidebarResizeThrottle=16,this.adUnits=[{name:"primary",type:0,detachedContainer:"#detached-moola-container",anchorNode:".moola-detached-container"},{name:"secondary",type:4,detachedContainer:"#detached-moola-second-sidebar-container",anchorNode:".moola-second-detached-container"}],this.params=t,e.Promise.resolve()},loadState:function(){let e=this;return this.appContext.getModel("photo-models",e.photoId).then((function(t){e.set("photo",t),e.appContext.adManager.canShowAdWithPhoto(e.get("photo"))||(e.showPhotoPageAd=!1)}))},buildContainer:function(){this.setContainerWithTemplate("photo-page-scrolling-sidebar",{showGettyWidget:this.showGettyWidget,canSeeAds:this.showPhotoPageAd,benefits:o.PRO_BENEFITS})},activate:function(){let t=!1,o=this.get("container"),i=this,n=i.get("photo");return this.registerEventHandler(o.one(".fave-count").on("click",this.faveCountClicked.bind(this))),this.registerEventHandler(o.one(".comment-count").on("click",this.commentCountClicked.bind(this))),this.registerEventHandler(e.on("resize",e.betterThrottle((t=>{this.showGettyWidget||(this.showPhotoPageAd&&this.appContext.viewportData.getWidthWithScrollbars()>=1081?e.one("body").one("#detached-moola-container .detached-moola-unit")&&e.one("body").one("#detached-moola-second-sidebar-container .detached-moola-unit")||this.setDetachedMoolaUnits():(e.one("body").one("#detached-moola-container .detached-moola-unit")||e.one("body").one("#detached-moola-second-sidebar-container .detached-moola-unit"))&&this.appContext.adManager.removeDetachedAdUnit())}),this.sidebarResizeThrottle,this))),this.showGettyWidget?(n&&this.registerEventHandler(n.on("valuesChanged",(function(e){e.safetyLevel&&i.canShowGettyWidget()}))),this.canShowGettyWidget(),t=!1):this.showPhotoPageAd?this.appContext.viewportData.getWidthWithScrollbars()>=1081&&(t=!0):(o.one(".moola-content-spacing")&&o.one(".moola-content-spacing").setStyle("display","none"),this.appContext.adManager.destroyAdUnitsOnPage(!0)),t&&this.setDetachedMoolaUnits(),this.setSiblingObserver(),e.Promise.resolve()},canShowGettyWidget:function(){let e=this.showGettyWidget,t=this.get("photo");this.appContext.adManager.canShowAdWithPhoto(t)&&this.appContext.gettyHelper.canShowWidgetType()?this.showGettyWidget=!1:this.showGettyWidget=!0,e!==this.showGettyWidget&&this.buildContainer()},faveCountClicked:function(t,o){t.preventDefault();var i=new e.Views["photo-faves-list-view"]({photoId:this.photoId,appContext:this.appContext});this.favesModal=new e.Views.FluidModal({appContext:this.appContext,subview:i,height:550,flexLayout:!0,hasSubviewConfigRefactor:!0,theme:this.params.theme}),this.favesModal.show(),e.Snowplough.sendStructuredEvent({category:"photopageinteractions",action:"sidebarFaveCountClick"})},commentCountClicked:function(){var t={appContext:this.appContext,photoId:this.photoId,isScrollable:!0,hasHeader:!0},o=new e.ModalDroparoundHelper(this.appContext,{useViewportType:!1,containerType:"modal",configs:{common:{subviewName:"photo-comments-view",subviewParams:t},modal:{height:550,flexLayout:!0,theme:this.params.theme}}});this.registerEventHandler(o.on("close",(()=>{e.fire("photoCommentModalClosed",{photoId:this.photoId})}))),this.registerEventHandler(e.on("addComment:showingSignupModal",(()=>{o.close()}))),o.show(),e.Snowplough.sendStructuredEvent({category:"photopageinteractions",action:"sidebarCommentsCountClick"})},setDetachedMoolaUnits:function(){this.setDetachedMoolaUnit(this.adUnits[0]),this.setDetachedMoolaUnit(this.adUnits[1])},setDetachedMoolaUnit:function(t){const o=this.get("container");this[`${t.name}AdSettings`]=this.getAdSettings(0),this[`${t.name}AdConfig`]=this.getAdConfig(this[`${t.name}AdSettings`],e.one("body").one(t.detachedContainer),o.one(t.anchorNode)),this.registerEventHandler(e.on("resize",e.betterThrottle((e=>{this.appContext.adManager.repositionDetachedMoolaUnit(this[`${t.name}AdConfig`])}),this.sidebarResizeThrottle,this))),this.registerEventHandler(e.on("globalNav:bannerSubviewActivated",(()=>{this.appContext.adManager.repositionDetachedMoolaUnit(this[`${t.name}AdConfig`])}))),document.querySelector(`${t.detachedContainer} .detached-moola-unit`)||(this.appContext.adManager.initDetachedMoolaUnit(this[`${t.name}AdConfig`]),this[`${t.name}AdSettings`].requestAd(),this.detachedSanityCheck=setTimeout((()=>{this.appContext.adManager.repositionDetachedMoolaUnit(this[`${t.name}AdConfig`]),clearTimeout(this.detachedSanityCheck)}),500))},getAdSettings:function(e){return this.appContext.adManager.getAd(this,{position:"photopage",name:"sidebar",type:e,categories:this.appContext.flipper.isFlipped("enable-page-categorizations")?this.appContext.adManager.getAdCategories(this.get("categories")):"",class:"detached-moola-unit",theme:this.params.theme})},getAdConfig:function(e,t,o){return{template:e.getAdTemplate(),detachedContainer:t,anchorNode:o,route:"photo-route"}},setSiblingObserver:function(){const e=this.get("container").getDOMNode();this.nodeObserver=new MutationObserver((e=>{e.forEach((e=>{"childList"===e.type&&this.get("container").one(".moola-detached-container")&&this.showPhotoPageAd&&this.adUnits.forEach((e=>{this.appContext.adManager.repositionDetachedMoolaUnit(this[`${e.name}AdConfig`])}))}))}));this.nodeObserver.observe(e,{childList:!0,subtree:!0})},destructor:function(){this.nodeObserver&&this.nodeObserver.disconnect&&this.nodeObserver.disconnect(),this.appContext.adManager.nextPhotoIsAdFriendly()||this.appContext.adManager.destroyAdUnitsOnPage(!0)}},{})}),"@VERSION@",{requires:["flickr-view","hermes-template-photo-page-scrolling-sidebar","hermes-template-prbd-moola-position","hermes-template-pro-benefits-list","attribution-view","sub-photo-right-stats-view","sub-photo-date-view","photo-license-view","fluid-modal-view","fluid-droparound-view","getty-widget-view","photo-page-sidebar-popular-photos-view"],optionalRequires:["hermes-core"],optional:["photo-models"],langBundles:["photo-page-scrappy","common"]});YUI.add("yui-throttle",function(e,t){
/*! Based on work by Simon Willison: http://gist.github.com/292562 */
;e.throttle=function(t,n){n=n?n:e.config.throttleTime||150;if(n===-1)return function(){t.apply(this,arguments)};var r=e.Lang.now();return function(){var i=e.Lang.now();i-r>n&&(r=i,t.apply(this,arguments))}}},"3.16.0",{requires:["yui-base"]});
YUI.add("hermes-template-photo-well-scrappy",(function(n,l){var e=n.Template.Handlebars.revive({1:function(n,l,e,t,a){return" enable-zoom"},3:function(n,l,e,t,a){return"server-only-link"},5:function(n,l,e,t,a){return" no-click"},7:function(n,l,e,t,a){return" is-hidden"},9:function(n,l,e,t,a){var o,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return n.escapeExpression("function"==typeof(o=null!=(o=r(e,"prev-url")||(null!=l?r(l,"prev-url"):l))?o:n.hooks.helperMissing)?o.call(null!=l?l:n.nullContext||{},{name:"prev-url",hash:{},data:a,loc:{start:{line:2,column:190},end:{line:2,column:202}}}):o)},11:function(n,l,e,t,a){return"#"},13:function(n,l,e,t,a){var o,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return n.escapeExpression("function"==typeof(o=null!=(o=r(e,"prev-title")||(null!=l?r(l,"prev-title"):l))?o:n.hooks.helperMissing)?o.call(null!=l?l:n.nullContext||{},{name:"prev-title",hash:{},data:a,loc:{start:{line:2,column:243},end:{line:2,column:257}}}):o)},15:function(n,l,e,t,a){var o,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return n.escapeExpression("function"==typeof(o=null!=(o=r(e,"next-url")||(null!=l?r(l,"next-url"):l))?o:n.hooks.helperMissing)?o.call(null!=l?l:n.nullContext||{},{name:"next-url",hash:{},data:a,loc:{start:{line:7,column:190},end:{line:7,column:202}}}):o)},17:function(n,l,e,t,a){var o,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return n.escapeExpression("function"==typeof(o=null!=(o=r(e,"next-title")||(null!=l?r(l,"next-title"):l))?o:n.hooks.helperMissing)?o.call(null!=l?l:n.nullContext||{},{name:"next-title",hash:{},data:a,loc:{start:{line:7,column:244},end:{line:7,column:258}}}):o)},19:function(n,l,e,t,a){var o=null!=l?l:n.nullContext||{},r=n.hooks.helperMissing,i=n.escapeExpression,u=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return"\t\t"+i((u(e,"outlet")||l&&u(l,"outlet")||r).call(o,null!=l?u(l,"photo-sidebar-toggle-view"):l,{name:"outlet",hash:{},data:a,loc:{start:{line:10,column:2},end:{line:10,column:38}}}))+"\n\t\t"+i((u(e,"outlet")||l&&u(l,"outlet")||r).call(o,null!=l?u(l,"attribution-view"):l,{name:"outlet",hash:{},data:a,loc:{start:{line:11,column:2},end:{line:11,column:29}}}))+"\n\t\t"+i((u(e,"outlet")||l&&u(l,"outlet")||r).call(o,null!=l?u(l,"people-notes-view"):l,{name:"outlet",hash:{},data:a,loc:{start:{line:12,column:2},end:{line:12,column:30}}}))+"\n\t\t"+i((u(e,"outlet")||l&&u(l,"outlet")||r).call(o,null!=l?u(l,"photo-engagement-view"):l,{name:"outlet",hash:{},data:a,loc:{start:{line:13,column:2},end:{line:13,column:34}}}))+"\n"},21:function(n,l,e,t,a){var o,r=null!=l?l:n.nullContext||{},i=n.hooks.helperMissing,u="function",c=n.escapeExpression,s=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return"\t\t<a class='entry-type do-not-evict' href='"+c(typeof(o=null!=(o=s(e,"entryURL")||(null!=l?s(l,"entryURL"):l))?o:i)===u?o.call(r,{name:"entryURL",hash:{},data:a,loc:{start:{line:17,column:43},end:{line:17,column:55}}}):o)+'\'><div class="icon"></div> '+c(typeof(o=null!=(o=s(e,"backToLabel")||(null!=l?s(l,"backToLabel"):l))?o:i)===u?o.call(r,{name:"backToLabel",hash:{},data:a,loc:{start:{line:17,column:82},end:{line:17,column:97}}}):o)+"</a>\n"},23:function(n,l,e,t,a){var o,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return null!=(o=(r(e,"isFlipped")||l&&r(l,"isFlipped")||n.hooks.helperMissing).call(null!=l?l:n.nullContext||{},"enable-dark-photopage-with-sidebar",{name:"isFlipped",hash:{},fn:n.program(24,a,0),inverse:n.noop,data:a,loc:{start:{line:23,column:2},end:{line:27,column:16}}}))?o:""},24:function(n,l,e,t,a){var o=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'\t\t\t<div class="get-pro-well-link">\n\t\t\t\t<a href="/account/upgrade/pro?utm=source=photopage&utm_campaign=photowell"><span class="sparkle">âœ¨</span> '+n.escapeExpression((o(e,"intlMessage")||l&&o(l,"intlMessage")||n.hooks.helperMissing).call(null!=l?l:n.nullContext||{},{name:"intlMessage",hash:{intlName:"common.GET_PRO"},data:a,loc:{start:{line:25,column:110},end:{line:25,column:151}}}))+"</a>\n\t\t\t</div>\n"},compiler:[8,">= 4.3.0"],main:function(n,l,e,t,a){var o,r,i=null!=l?l:n.nullContext||{},u=n.hooks.helperMissing,c="function",s=n.escapeExpression,p=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'<div class="height-controller'+(null!=(o=p(e,"if").call(i,null!=l?p(l,"enableZoom"):l,{name:"if",hash:{},fn:n.program(1,a,0),inverse:n.noop,data:a,loc:{start:{line:1,column:29},end:{line:1,column:66}}}))?o:"")+'" style="height: '+s(typeof(r=null!=(r=p(e,"height")||(null!=l?p(l,"height"):l))?r:u)===c?r.call(i,{name:"height",hash:{},data:a,loc:{start:{line:1,column:83},end:{line:1,column:93}}}):r)+'px;">\n\t<a class="'+(null!=(o=p(e,"if").call(i,null!=l?p(l,"serverRenderNav"):l,{name:"if",hash:{},fn:n.program(3,a,0),inverse:n.noop,data:a,loc:{start:{line:2,column:11},end:{line:2,column:57}}}))?o:"")+" navigate-target navigate-prev"+(null!=(o=p(e,"if").call(i,null!=l?p(l,"prev-is-not-clickable"):l,{name:"if",hash:{},fn:n.program(5,a,0),inverse:n.noop,data:a,loc:{start:{line:2,column:87},end:{line:2,column:132}}}))?o:"")+(null!=(o=p(e,"if").call(i,null!=l?p(l,"is-hidden"):l,{name:"if",hash:{},fn:n.program(7,a,0),inverse:n.noop,data:a,loc:{start:{line:2,column:132},end:{line:2,column:166}}}))?o:"")+'" href="'+(null!=(o=p(e,"if").call(i,null!=l?p(l,"prev-url"):l,{name:"if",hash:{},fn:n.program(9,a,0),inverse:n.program(11,a,0),data:a,loc:{start:{line:2,column:174},end:{line:2,column:218}}}))?o:"")+'" title="'+(null!=(o=p(e,"if").call(i,null!=l?p(l,"prev-url"):l,{name:"if",hash:{},fn:n.program(13,a,0),inverse:n.noop,data:a,loc:{start:{line:2,column:227},end:{line:2,column:264}}}))?o:"")+'" data-track="prevPhotoButtonClick" data-action="ad" style="height: '+s(typeof(r=null!=(r=p(e,"navHeight")||(null!=l?p(l,"navHeight"):l))?r:u)===c?r.call(i,{name:"navHeight",hash:{},data:a,loc:{start:{line:2,column:332},end:{line:2,column:345}}}):r)+'px;"><span class="hide-text">&larr;</span></a>\n\n\t'+s((p(e,"outlet")||l&&p(l,"outlet")||u).call(i,null!=l?p(l,"photo-well-media-view"):l,{name:"outlet",hash:{},data:a,loc:{start:{line:4,column:1},end:{line:4,column:33}}}))+"\n\t"+s((p(e,"outlet")||l&&p(l,"outlet")||u).call(i,null!=l?p(l,"photo-notes-scrappy-view"):l,{name:"outlet",hash:{},data:a,loc:{start:{line:5,column:1},end:{line:5,column:36}}}))+'\n\t\n\t<a class="'+(null!=(o=p(e,"if").call(i,null!=l?p(l,"serverRenderNav"):l,{name:"if",hash:{},fn:n.program(3,a,0),inverse:n.noop,data:a,loc:{start:{line:7,column:11},end:{line:7,column:57}}}))?o:"")+" navigate-target navigate-next"+(null!=(o=p(e,"if").call(i,null!=l?p(l,"next-is-not-clickable"):l,{name:"if",hash:{},fn:n.program(5,a,0),inverse:n.noop,data:a,loc:{start:{line:7,column:87},end:{line:7,column:132}}}))?o:"")+(null!=(o=p(e,"if").call(i,null!=l?p(l,"is-hidden"):l,{name:"if",hash:{},fn:n.program(7,a,0),inverse:n.noop,data:a,loc:{start:{line:7,column:132},end:{line:7,column:166}}}))?o:"")+'" href="'+(null!=(o=p(e,"if").call(i,null!=l?p(l,"next-url"):l,{name:"if",hash:{},fn:n.program(15,a,0),inverse:n.program(11,a,0),data:a,loc:{start:{line:7,column:174},end:{line:7,column:218}}}))?o:"")+'"  title="'+(null!=(o=p(e,"if").call(i,null!=l?p(l,"next-url"):l,{name:"if",hash:{},fn:n.program(17,a,0),inverse:n.noop,data:a,loc:{start:{line:7,column:228},end:{line:7,column:265}}}))?o:"")+'" data-track="nextPhotoButtonClick" data-action="ad" style="height: '+s(typeof(r=null!=(r=p(e,"navHeight")||(null!=l?p(l,"navHeight"):l))?r:u)===c?r.call(i,{name:"navHeight",hash:{},data:a,loc:{start:{line:7,column:333},end:{line:7,column:346}}}):r)+'px;"><span class="hide-text">&rarr;</span></a>\n\n'+(null!=(o=p(e,"unless").call(i,null!=l?p(l,"is-ad"):l,{name:"unless",hash:{},fn:n.program(19,a,0),inverse:n.noop,data:a,loc:{start:{line:9,column:1},end:{line:14,column:12}}}))?o:"")+"\n"+(null!=(o=p(e,"unless").call(i,null!=l?p(l,"hideBackToLink"):l,{name:"unless",hash:{},fn:n.program(21,a,0),inverse:n.noop,data:a,loc:{start:{line:16,column:1},end:{line:18,column:12}}}))?o:"")+"\n\t"+s((p(e,"outlet")||l&&p(l,"outlet")||u).call(i,null!=l?p(l,"context-slider-view"):l,{name:"outlet",hash:{},data:a,loc:{start:{line:20,column:1},end:{line:20,column:31}}}))+"\n\n"+(null!=(o=p(e,"if").call(i,null!=l?p(l,"viewerIsPro"):l,{name:"if",hash:{},fn:n.noop,inverse:n.program(23,a,0),data:a,loc:{start:{line:22,column:1},end:{line:28,column:8}}}))?o:"")+"</div>\n"},useData:!0}),t={};n.Array.each([],(function(l){var e=n.Template.get("hermes/"+l);e&&(t[l]=e)})),n.Template.register("hermes/photo-well-scrappy",(function(l,a){return(a=a||{}).partials=a.partials?n.merge(t,a.partials):t,e(l,a)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-photo-page-right-size-express",(function(t,e){var n=t.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(t,e,n,i,o){var a,h=null!=e?e:t.nullContext||{},l=t.hooks.helperMissing,r="function",p=t.escapeExpression,d=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\n<script type="text/javascript" nonce="'+p(typeof(a=null!=(a=d(n,"cspNonce")||(null!=e?d(e,"cspNonce"):e))?a:l)===r?a.call(h,{name:"cspNonce",hash:{},data:o,loc:{start:{line:12,column:38},end:{line:12,column:50}}}):a)+'">\n\n\t(function(){\n\n\t\tvar PADDING_HORIZONTAL = 40;\n\n\t\twindow.getPhotoWellHeight = function () {\n\n\t\t\tvar minHeight = 500,\n\t\t\t    winWidth = window.innerWidth,\n\t\t\t    winHeight = window.innerHeight - 50,  \n\t\t\t    ratioNarrow = 1,\n\t\t\t    ratioRegular = 2.3,\n\t\t\t    ratioTransitional = 2.75,\n\t\t\t    idealSubphotoHeight = 120,\n\t\t\t    breakHeightNarrow = (winWidth / ratioNarrow) + idealSubphotoHeight,\n\t\t\t    breakHeightRegular = (winWidth / ratioRegular) + idealSubphotoHeight,\n\t\t\t    breakHeightTransitional = winWidth / ratioTransitional,\n\t\t\t    newPhotoWellHeight;\n\n\t\t\tif (winHeight > breakHeightNarrow) {\n\n\t\t\t\tnewPhotoWellHeight = winWidth / ratioNarrow;\n\n\t\t\t} else if (winHeight > breakHeightRegular) {\n\n\t\t\t\tnewPhotoWellHeight = winHeight - idealSubphotoHeight;\n\n\t\t\t} else if (winHeight > breakHeightTransitional) {\n\n\t\t\t\tnewPhotoWellHeight = winHeight - idealSubphotoHeight + idealSubphotoHeight * (winHeight - breakHeightRegular) / (breakHeightTransitional - breakHeightRegular);\n\n\t\t\t} else {\n\n\t\t\t\tnewPhotoWellHeight = winHeight;\n\n\t\t\t}\n\n\t\t\treturn Math.max(minHeight, Math.round(newPhotoWellHeight));\n\n\t\t}\n\n\t\tfunction domReady () {\n\n\t\t\ttry {\n\n\t\t\t\tif (document.getElementsByClassName("main-photo")[0]) {\n\n\t\t\t\t\tvar photoWellView = document.querySelector(".photo-well-scrappy-view"),\n\t\t\t\t\t    heightController = photoWellView.getElementsByClassName("height-controller")[0],\n\t\t\t\t\t    photoWellMediaView = document.querySelector(".photo-well-media-scrappy-view"),\n\t\t\t\t\t    photoImageElement = photoWellMediaView.getElementsByClassName("main-photo")[0],\n\t\t\t\t\t    photoWidth = '+p(typeof(a=null!=(a=d(n,"photoWidth")||(null!=e?d(e,"photoWidth"):e))?a:l)===r?a.call(h,{name:"photoWidth",hash:{},data:o,loc:{start:{line:100,column:22},end:{line:100,column:36}}}):a)+",\n\t\t\t\t\t    photoHeight = "+p(typeof(a=null!=(a=d(n,"photoHeight")||(null!=e?d(e,"photoHeight"):e))?a:l)===r?a.call(h,{name:"photoHeight",hash:{},data:o,loc:{start:{line:101,column:23},end:{line:101,column:38}}}):a)+",\n\t\t\t\t\t    photoAspectRatio = photoWidth / photoHeight,\n\t\t\t\t\t    photoWellHeight = window.getPhotoWellHeight(),\n\t\t\t\t\t    photoWellMediaViewPadding = {\n\t\t\t\t\t        top: parseInt(getComputedStyle(photoWellMediaView)['paddingTop'].match(/[0-9]+/)[0], 10),\n\t\t\t\t\t        right: PADDING_HORIZONTAL,\n\t\t\t\t\t        bottom: parseInt(getComputedStyle(photoWellMediaView)['paddingBottom'].match(/[0-9]+/)[0], 10),\n\t\t\t\t\t        left: PADDING_HORIZONTAL\n\t\t\t\t\t    },\n\t\t\t\t\t    canvasSize = {\n\t\t\t\t\t        height: photoWellHeight - photoWellMediaViewPadding.top - photoWellMediaViewPadding.bottom,\n\t\t\t\t\t        width: window.innerWidth - photoWellMediaViewPadding.left - photoWellMediaViewPadding.right\n\t\t\t\t\t    };\n\n\t\t\t\t\tif ("+p(typeof(a=null!=(a=d(n,"sidebarActive")||(null!=e?d(e,"sidebarActive"):e))?a:l)===r?a.call(h,{name:"sidebarActive",hash:{},data:o,loc:{start:{line:115,column:9},end:{line:115,column:26}}}):a)+") {\n\t\t\t\t\t\tcanvasSize.width = (canvasSize.width - "+p((d(n,"flickrConfig")||e&&d(e,"flickrConfig")||l).call(h,"photopage.sidebarWidth",{name:"flickrConfig",hash:{},data:o,loc:{start:{line:116,column:45},end:{line:116,column:86}}}))+');\n\t\t\t\t\t\tcanvasSize.height = canvasSize.width / photoAspectRatio;\n\t\t\t\t\t}\n\n\t\t\t\t\theightController.style.height = photoWellHeight + "px";\n\n\t\t\t\t\tif (photoWidth <= canvasSize.width && photoHeight <= canvasSize.height) {\n\t\t\t\t\t\tphotoImageElement.style.height = photoHeight + "px";\n\t\t\t\t\t\tphotoImageElement.style.width = photoWidth + "px";\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (photoAspectRatio < 1 || Math.round(canvasSize.width / photoAspectRatio) > canvasSize.height) {\n\t\t\t\t\t\t\tphotoImageElement.style.height = canvasSize.height + "px";\n\t\t\t\t\t\t\tphotoImageElement.style.width = Math.round(canvasSize.height * photoAspectRatio) + "px";\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tphotoImageElement.style.height = Math.round(canvasSize.width / photoAspectRatio) + "px";\n\t\t\t\t\t\t\tphotoImageElement.style.width = canvasSize.width + "px";\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t} catch (e) {\n\t\t\t\tif (window.sendRequest) {\n\t\t\t\t\twindow.sendRequest(\'flickr.hermes.photoDimensionCorrectionError\', \'There was a JS error when trying to correct a server rendered photo.\');\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t\tif (document.readyState !== \'loading\') {\n\t\t\tdomReady();\n\t\t} else {\n\t\t\tdocument.addEventListener(\'DOMContentLoaded\', domReady);\n\t\t}\n\n\t}());\n\n<\/script>\n'},useData:!0}),i={};t.Array.each([],(function(e){var n=t.Template.get("hermes/"+e);n&&(i[e]=n)})),t.Template.register("hermes/photo-page-right-size-express",(function(e,o){return(o=o||{}).partials=o.partials?t.merge(i,o.partials):i,n(e,o)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-vr-overlay",(function(e,a){var r=e.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(e,a,r,t,s){return'<a class="close"><span></span></a>'},useData:!0}),t={};e.Array.each([],(function(a){var r=e.Template.get("hermes/"+a);r&&(t[a]=r)})),e.Template.register("hermes/vr-overlay",(function(a,s){return(s=s||{}).partials=s.partials?e.merge(t,s.partials):t,r(a,s)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});
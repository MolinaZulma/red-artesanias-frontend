YUI.add("hermes-template-search-empty",(function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,l,a){return"safe-search"},3:function(e,t,n,l,a){var s,r=e.escapeExpression,o=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'\t\t\t<div class="no-results-message">\n\t\t\t\t<h5>'+r(e.lambda(null!=(s=null!=t?o(t,"noMatchesForQuery"):t)?o(s,"noMatchesText"):s,t))+"</h5>\n\t\t\t\t<h5>"+r((o(n,"intlMessage")||t&&o(t,"intlMessage")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},{name:"intlMessage",hash:{intlName:"search.TRY_DIFFERENT_BROADER"},data:a,loc:{start:{line:6,column:8},end:{line:6,column:63}}}))+"</h5>\n\t\t\t</div>\n"},5:function(e,t,n,l,a){var s=null!=t?t:e.nullContext||{},r=e.hooks.helperMissing,o=e.escapeExpression,i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'\t\t\t<div class="no-results-message">\n\t\t\t\t<h5>'+o((i(n,"intlMessage")||t&&i(t,"intlMessage")||r).call(s,{name:"intlMessage",hash:{intlName:"search.API_ERROR_HEADER"},data:a,loc:{start:{line:11,column:8},end:{line:11,column:58}}}))+"</h5>\n\t\t\t\t<h5>"+o((i(n,"intlMessage")||t&&i(t,"intlMessage")||r).call(s,{name:"intlMessage",hash:{intlName:"search.API_ERROR_SUBHEADER"},data:a,loc:{start:{line:12,column:8},end:{line:12,column:61}}}))+"</h5>\n\t\t\t</div>\n"},7:function(e,t,n,l,a){var s,r=e.lambda,o=e.escapeExpression,i=null!=t?t:e.nullContext||{},c=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'\t\t\t<div class="no-results-message safe-search">\n\t\t\t\t<h5>'+o(r(null!=(s=null!=t?c(t,"safeSearchLimitedResults"):t)?c(s,"safeSearchLimitedResultsText"):s,t))+'</h5>\n\t\t\t\t<button class="flex hollow black disable-safe-search '+(null!=(s=c(n,"if").call(i,null!=(s=null!=t?c(t,"safeSearchLimitedResults"):t)?c(s,"showSafeSearchDropdown"):s,{name:"if",hash:{},fn:e.program(8,a,0),inverse:e.noop,data:a,loc:{start:{line:18,column:57},end:{line:18,column:129}}}))?s:"")+'">\n\t\t\t\t\t'+o(r(null!=(s=null!=t?c(t,"safeSearchLimitedResults"):t)?c(s,"safeSearchLimitedResultsButtonText"):s,t))+"\n"+(null!=(s=c(n,"if").call(i,null!=(s=null!=t?c(t,"safeSearchLimitedResults"):t)?c(s,"showSafeSearchDropdown"):s,{name:"if",hash:{},fn:e.program(10,a,0),inverse:e.noop,data:a,loc:{start:{line:20,column:5},end:{line:24,column:12}}}))?s:"")+"\t\t\t\t</button>\n\t\t\t</div>\n"},8:function(e,t,n,l,a){return"with-arrow"},10:function(e,t,n,l,a){return'\t\t\t\t\t\t<span class="arrow">\n\t\t\t\t\t\t\t<svg class="icon icon-dropdown_arrow"><use xlink:href="#icon-dropdown_arrow"></use></svg>\n\t\t\t\t\t\t</span>\n'},compiler:[8,">= 4.3.0"],main:function(e,t,n,l,a){var s,r=null!=t?t:e.nullContext||{},o=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="search-empty '+(null!=(s=o(n,"if").call(r,null!=t?o(t,"safeSearchLimitedResults"):t,{name:"if",hash:{},fn:e.program(1,a,0),inverse:e.noop,data:a,loc:{start:{line:1,column:25},end:{line:1,column:75}}}))?s:"")+'">\n\t<div class="no-results-message-container">\n'+(null!=(s=o(n,"if").call(r,null!=t?o(t,"noMatchesForQuery"):t,{name:"if",hash:{},fn:e.program(3,a,0),inverse:e.noop,data:a,loc:{start:{line:3,column:2},end:{line:8,column:9}}}))?s:"")+(null!=(s=o(n,"if").call(r,null!=t?o(t,"apiFailed"):t,{name:"if",hash:{},fn:e.program(5,a,0),inverse:e.noop,data:a,loc:{start:{line:9,column:2},end:{line:14,column:9}}}))?s:"")+(null!=(s=o(n,"if").call(r,null!=t?o(t,"safeSearchLimitedResults"):t,{name:"if",hash:{},fn:e.program(7,a,0),inverse:e.noop,data:a,loc:{start:{line:15,column:2},end:{line:27,column:9}}}))?s:"")+"\t</div>\n</div>\n\n"},useData:!0}),l={};e.Array.each([],(function(t){var n=e.Template.get("hermes/"+t);n&&(l[t]=n)})),e.Template.register("hermes/search-empty",(function(t,a){return(a=a||{}).partials=a.partials?e.merge(l,a.partials):l,n(t,a)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("search-empty-view",(function(e){"use strict";var t=[{intlKey:"search.SAFESEARCH_ON",value:"safe",prefValue:0,isDefault:!0},{intlKey:"search.SAFESEARCH_MODERATE",value:"moderate",prefValue:1},{intlKey:"search.SAFESEARCH_OFF",value:"restricted",prefValue:2}];e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(a){var s=a.modelParams&&a.modelParams.apiParams?e.merge(a.modelParams.apiParams):{};this.searchUrl=new e.SearchUrl(s,this.appContext,a.searchType||e.SearchUrl.searchTypes.UNDEFINED),this.searchType=a.searchType,this.isMobile=a.isMobile;var r,i=this.searchUrl.getAPIParam(e.SearchHelper.API.safeSearch);this.safeSearches=[],t.forEach((t=>{r=e.merge(t,{text:this.intlMessage({intlName:t.intlKey})}),i?r.value===i&&(r.isSelected=!0,this.set("selectedSafeSearch",r.value),this.set("selectedSafeSearchText",r.text),this.usedAPISafeSearch=!0):r.isDefault&&(r.isSelected=!0,this.set("selectedSafeSearch",r.value),this.set("selectedSafeSearchText",r.text)),this.safeSearches.push(r)})),""===this.get("container").get("innerHTML")&&this.setContainerHTML("")},loadState:function(){var t=[];return this.appContext.getViewer().signedIn&&t.push(this.appContext.getModel("person-preferences-models",this.appContext.getViewer().nsid).then((e=>{this.set("viewerPrefsModel",e),this.safeSearches.forEach((t=>{t.isDefault=!1,this.usedAPISafeSearch||(t.isSelected=!1),t.prefValue===e.getValue("safeSearch")&&(this.usedAPISafeSearch||(t.isSelected=!0,this.set("selectedSafeSearch",t.value),this.set("selectedSafeSearchText",t.text)),t.isDefault=!0)}))}))),e.Promise.all(t)},buildContainer:function(){var t="search.PHOTOS_PEOPLE_OR_GROUPS";return this.isMobile&&(this.searchType===e.SearchUrl.searchTypes.PHOTOS?t="search.SEARCH_PHOTOS":this.searchType===e.SearchUrl.searchTypes.PEOPLE?t="search.SEARCH_PEOPLE":this.searchType===e.SearchUrl.searchTypes.GROUPS&&(t="search.SEARCH_GROUPS")),t=this.intlMessage({intlName:t}),this.setContainerWithTemplate("search-empty",{searchPlaceholder:t,noMatchesForQuery:this.get("noMatchesForQuery"),apiFailed:this.get("apiFailed"),safeSearchLimitedResults:this.get("safeSearchLimitedResults")}),this},activate:function(){var e=this.get("container"),t=e.one("#search-field"),a=e.one(".disable-safe-search");return t&&setTimeout((function(){let e=t.getDOMNode(),a=e.value.length;e.setSelectionRange(a,a),t.focus()}),1e3),a&&this.registerEventHandler(a.on("click",(()=>{this.get("safeSearchLimitedResults").showSafeSearchDropdown?this.createSafeSearchDroparound():this.get("safeSearchLimitedResults").showAdultGroupsToggle&&this.showAdultGroups()}))),this},enableBlankState:function(e){this.get("container").addClass("blank")},onParentViewEvent:function(e,t){t&&"error-msg-updated"===t[0]&&(this.isBuilt&&this.buildContainer(),this.isActivated&&this.activate())},createSafeSearchDroparound:function(){var t=this.get("container").one(".disable-safe-search").one(".arrow");this.safeSearchMenu=new e.Views.FluidDroparound({appContext:this.appContext,dismissOnActionClick:!0,showDropArrow:!0,anchorElement:t,classList:"",overlayClassList:"",menuItems:this.safeSearches,preferBottom:!0,anchorOffsetVertical:-8}),this.safeSearchMenu.show(),this.registerEventHandler(this.safeSearchMenu.on("selected",(t=>{if(this.safeSearchMenu.close(),this.appContext.getViewer().signedIn||"moderate"!==t.menuItem.value&&"restricted"!==t.menuItem.value){switch(t.menuItem.value){case"safe":this.searchUrl.setAPIParam(e.SearchHelper.API.safeSearch,e.SearchHelper.PHOTOS_SAFE_SEARCH_SETTINGS.safe);break;case"moderate":this.searchUrl.setAPIParam(e.SearchHelper.API.safeSearch,e.SearchHelper.PHOTOS_SAFE_SEARCH_SETTINGS.moderate);break;case"restricted":this.searchUrl.setAPIParam(e.SearchHelper.API.safeSearch,e.SearchHelper.PHOTOS_SAFE_SEARCH_SETTINGS.restricted)}this.fire("subviewViewEvent","search:dirty"),this.appContext.flapp.navigate(this.searchUrl.getURL())}else this.showSignUpModal()})))},showAdultGroups:function(){this.appContext.getViewer().signedIn?(this.searchUrl.setAPIParam(e.SearchHelper.GROUPS_SEARCH_API.safeSearch,e.SearchHelper.GROUPS_SAFE_SEARCH_SETTINGS.all),this.appContext.flapp.navigate(this.searchUrl.getURL())):this.showSignUpModal()},showSignUpModal:function(){var t,a=e.config.win.location.href,s=this.intlMessage({intlName:"search.SIGN_IN_BEFORE_SEARCH_TITLE"}),r=this.intlMessage({intlName:"search.SIGN_IN_BEFORE_SEARCH_MESSAGE"});(t=new e.Views.SignUpModal({appContext:this.appContext,signUpHeaderClass:"signup-search-mature",signUpTitle:s,signUpMessage:r,beaconPrefix:"searchFilter"})).on("signUpClick",(t=>{e.SigninHelper._redirectToSignUp("",{postLoginUrl:a})})),t.on("signInClick",(t=>{e.SigninHelper._redirectToSignin("",{postLoginUrl:a})})),t.show()}},{ATTRS:{noMatchesForQuery:{value:!1,validator:function(e,t){return!e||"object"==typeof e&&e.hasOwnProperty("noMatchesText")}},apiFailed:{value:!1,validator:function(t,a){return e.AttributeHelpers.validateBoolean(t)}},safeSearchLimitedResults:{value:!1,validator:function(e,t){return!e||"object"==typeof e&&e.hasOwnProperty("safeSearchLimitedResultsText")}}}})}),"@VERSION@",{requires:["flickr-view","flickr-promise","search-url","attribute-helpers","hermes-template-search-empty"],langBundles:["search"]});YUI.add("hermes-lang-shared-entity_es-us",(function(e,t){e.Intl.add("hermes/shared-entity","es-US",{USERNAME_HAS_SHARED_PHOTOS_ONLY:[{type:0,value:"ยก"},{type:1,value:"username"},{type:0,value:" ha compartido "},{type:6,value:"photoCount",options:{one:{value:[{type:7},{type:0,value:" foto"}]},other:{value:[{type:7},{type:0,value:" fotos"}]}},offset:0,pluralType:"cardinal"},{type:0,value:" contigo!"}],USERNAME_HAS_SHARED_VIDEOS_ONLY:[{type:0,value:"ยก"},{type:1,value:"username"},{type:0,value:" ha compartido "},{type:6,value:"videoCount",options:{one:{value:[{type:7},{type:0,value:" video"}]},other:{value:[{type:7},{type:0,value:" videos"}]}},offset:0,pluralType:"cardinal"},{type:0,value:" contigo!"}],USERNAME_HAS_SHARED_PHOTOS_VIDEOS:[{type:0,value:"ยก"},{type:1,value:"username"},{type:0,value:" ha compartido "},{type:6,value:"photoCount",options:{one:{value:[{type:7},{type:0,value:" foto"}]},other:{value:[{type:7},{type:0,value:" fotos"}]}},offset:0,pluralType:"cardinal"},{type:0,value:" "},{type:6,value:"videoCount",options:{one:{value:[{type:0,value:"y "},{type:7},{type:0,value:" video"}]},other:{value:[{type:0,value:"y "},{type:7},{type:0,value:" videos"}]}},offset:0,pluralType:"cardinal"},{type:0,value:" contigo!"}],OWNER_HAS_SHARED_PHOTOS_ONLY:[{type:0,value:"Has compartido "},{type:6,value:"photoCount",options:{one:{value:[{type:7},{type:0,value:" foto"}]},other:{value:[{type:7},{type:0,value:" fotos"}]}},offset:0,pluralType:"cardinal"},{type:0,value:"."}],OWNER_HAS_SHARED_VIDEOS_ONLY:[{type:0,value:"Has compartido "},{type:6,value:"videoCount",options:{one:{value:[{type:7},{type:0,value:" video"}]},other:{value:[{type:7},{type:0,value:" videos"}]}},offset:0,pluralType:"cardinal"},{type:0,value:"."}],OWNER_HAS_SHARED_PHOTOS_VIDEOS:[{type:0,value:"Has compartido "},{type:6,value:"photoCount",options:{one:{value:[{type:7},{type:0,value:" foto"}]},other:{value:[{type:7},{type:0,value:" fotos"}]}},offset:0,pluralType:"cardinal"},{type:0,value:" "},{type:6,value:"videoCount",options:{one:{value:[{type:0,value:"y "},{type:7},{type:0,value:" video"}]},other:{value:[{type:0,value:"y "},{type:7},{type:0,value:" videos"}]}},offset:0,pluralType:"cardinal"},{type:0,value:"."}],VIEW_YOUR_SHARING_HISTORY:[{type:0,value:"Ver tu historial de datos compartidos"}]})}),"@VERSION@",{requires:["intl"]});YUI.add("flickr-favorites-getContext-fetcher",(function(e,o){"use strict";e.namespace("ListFetchers")["flickr-favorites-getContext"]={run:function(t,s){var r=this;return e.Promise.all([s.callAPI("flickr.favorites.getContext",this._processParams(t),!0),s.getModelRegistry("favorite-models"),s.getModelRegistry("photo-models"),s.getModelRegistry("person-models"),s.getModelRegistry("photo-engagement-models"),s.getModelRegistry("photo-stats-models")]).then((function(e){return r._processResponse(e,t)}),(function(e){throw 3===e.code&&"Photo not a favorite"===e.message&&(e.notInContext=!0),e})).then(null,e.FetcherErrorLogger(o))},_processParams:function(o){var t={photo_id:o.photoId,num_prev:o.numNext,num_next:o.numPrev,extras:e.APIHelper.request.getRebootPhotoExtras()};return o.id?t.user_id=o.id:t.path_alias=o.pathAlias,t},_processResponse:function(o,t){var s,r,n,a,p,i,l,h,d=o[0],g=o[1],u=o[2],m=o[3],c=o[4],x=o[5],y=[],M=u.proxy(t.photoId);return r=d.prevphotos,n=d.nextphotos,s=e.APIHelper.response.parsePhotos({photos:r.photo,personModelRegistry:m,photoModelRegistry:u,photoEngagementModelRegistry:c,photoStatsModelRegistry:x}),y=e.APIHelper.response.parsePhotos({photos:n.photo,personModelRegistry:m,photoModelRegistry:u,photoEngagementModelRegistry:c,photoStatsModelRegistry:x}),p=!!(l=g.getValue(t.id,"photoContextList")).hasMinBoundary&&l.hasMinBoundary(),i=!!l.hasMaxBoundary&&l.hasMaxBoundary(),a=l.getList(),h=e.APIHelper.response.addOrReplaceListByContext({model:M,next:s,prev:y.reverse(),hasMax:i,hasMin:p,current:a,numNext:t.numNext,numPrev:t.numPrev}),g.setValue(t.id,"photoContextList",h),{next:s,previous:y.reverse()}}}}),"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["favorite-models","photo-models","person-models","photo-engagement-models","photo-stats-models"]});YUI.add("flickr-favorites-getList-fetcher",(function(e,o){"use strict";e.namespace("ListFetchers")["flickr-favorites-getList"]={run:function(t,s){var r=this;return e.Promise.all([s.callAPI("flickr.favorites.getList",this._processParams(t)),s.getModelRegistry("photo-models"),s.getModelRegistry("person-models"),s.getModelRegistry("favorite-models"),s.getModelRegistry("photo-engagement-models"),s.getModelRegistry("photo-stats-models"),s.getModelRegistry("gallery-photo-association-models"),s.getModelRegistry("gallery-faves-models")]).then((function(e){return r._processResponse(e,t)}),e.FetcherErrorLogger(o))},_processParams:function(o){var t={extras:e.APIHelper.request.getRebootPhotoExtras(),per_page:o.perPage||20,page:o.page||1,get_user_info:1,jump_to:o.withPhotoId||""};if(o.id||o.userId)t.user_id=(o.id||o.userId).split("-")[0];else{if(!o.pathAlias)throw new Error("[flickr-favorites-getList-fetcher] `id` or `pathAlias` is required.");t.path_alias=o.pathAlias}return o.galleryId&&(t.gallery_id=o.galleryId),t},_processResponse:function(o,t){var s,r,a,p=o[0],l=o[1],i=o[2],d=o[3],g=o[4],h=o[5],n=o[6],y=o[7],c={id:p.user.nsid,pathAlias:p.user.pathAlias,totalItems:p.photos.total},u=t.id||t.userId,f=[];return u&&u!==c.id&&(c.id=u),r=e.APIHelper.response.parsePerson(p.user),c.owner=i.addOrUpdate(r),t.galleryId?(p.photos.photo.forEach((function(e){e.gallerynotaddable&&f.push(e)})),s=e.APIHelper.response.parsePhotos({photos:p.photos.photo,personModelRegistry:i,photoModelRegistry:l,photoEngagementModelRegistry:g,photoStatsModelRegistry:h}),a=e.APIHelper.response.parsePhotos({photos:f,personModelRegistry:i,photoModelRegistry:l,photoEngagementModelRegistry:g,photoStatsModelRegistry:h}),c.photoList={perPage:p.photos.perpage,page:p.photos.page,pageContent:s,totalItems:p.photos.total},c.id=r.id+"-"+t.galleryId,y.addOrUpdate(c).getValue("nonGalleryAddablePhotos").concat(a)):(s=e.APIHelper.response.parsePhotos({photos:p.photos.photo,personModelRegistry:i,photoModelRegistry:l,photoEngagementModelRegistry:g,photoStatsModelRegistry:h}),c.photoPageList={perPage:p.photos.perpage,page:p.photos.page,pageContent:s,totalItems:p.photos.total},d.addOrUpdate(c)),p.photos.photo&&p.photos.photo.forEach((function(e){e.ingallery&&n.addOrUpdate({id:t.galleryId+"-"+e.id,galleryId:t.galleryId,photoId:e.id})})),s}}}),"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["photo-models","person-models","favorite-models","photo-engagement-models","photo-stats-models"]});YUI.add("favorite-models",(function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ListFetchers["flickr-favorites-getList"].run(t,this.appContext)}},attributes:{normalizedId:{readOnly:!0,defaultFn:function(e){return e.split("-")[0]}},displayType:{readOnly:!0,defaultFn:function(){return"favorites"}},title:{readOnly:!0,derivedBy:["owner","normalizedId"],defaultFn:function(e){var t,r=this.appContext.getViewer(),i=this.getValue(e,"normalizedId");return r&&r.nsid===i?"Your favorites":(t=this.getValue(e,"owner"))?t.getValue("displayname")+"'s favorites":"Favorites"}},pathAlias:{validator:function(t,r){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)||void 0},defaultFn:function(e){return this.getValue(e,"normalizedId")}},owner:{isModel:!0},isOwner:e.PhotoModelHelper.attributes.isOwner,photoPageList:{isCollection:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-favorites-getList"]}},photoContextList:{isListProxy:!0,contextFetch:{listFetcher:e.ListFetchers["flickr-favorites-getContext"],listItemIdField:"photoId"}},url:{readOnly:!0,derivedBy:["owner","normalizedId"],defaultFn:function(e){var t=this.getValue(e,"owner"),r=this.getValue(e,"normalizedId");return"/photos/"+(t?t.getValue("pathAlias"):r)+"/favorites/"}},totalItems:{defaultFn:function(){return null}},urlSuffix:{readOnly:!0,derivedBy:["owner"],defaultFn:function(e){return"faves-"+this.getValue(e,"owner").getValue("pathAlias")}}}})}),"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-favorites-getContext-fetcher","flickr-favorites-getList-fetcher","photo-model-helper"]});YUI.add("flickr-galleries-getInfo-fetcher",(function(e,r){"use strict";e.namespace("ModelFetchers")["flickr-galleries-getInfo"]={run:function(o,t){var n=this,s=this._processParams(o);return e.FlickrPromise({apiResponse:t.callAPI("flickr.galleries.getInfo",s),galleryInfoModelRegistry:t.getModelRegistry("gallery-info-models"),personModelRegistry:t.getModelRegistry("person-models")}).then((function(e){return n._processResponse(e,o,t)}),e.FetcherErrorLogger(r))},_processResponse:function(e,r,o){var t,n,s=e.apiResponse,i=e.galleryInfoModelRegistry,a=(e.personModelRegistry,e.personModel,s.gallery);if(a)return o.getModel("person-models",a.owner).then((function(e){return n=e,t={id:r.id,compoundId:a.id,owner:n,username:a.username,primaryPhotoId:a.primary_photo_id,dateCreate:parseInt(a.date_create,10),dateUpdate:parseInt(a.date_update,10),photoCount:a.count_photos,videoCount:a.count_videos,viewCount:parseInt(a.count_views,10),commentCount:parseInt(a.count_comments,10),title:a.title._content,description:a.description._content,currentState:a.current_state,primary_photo_server:a.primary_photo_server,primary_photo_farm:a.primary_photo_farm,primary_photo_secret:a.primary_photo_secret},i.addOrUpdate(t)}))},_processParams:function(e){return{gallery_id:e.id}}}}),"@VERSION@",{requires:["flickr-promise","api-helper","url-helper"],optional:["gallery-info-models","person-models"]});